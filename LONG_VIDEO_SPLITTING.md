# Автоматическое разбиение длинных видео

## Обзор

Система автоматически разбивает видео длительностью более 1 часа на отдельные эпизоды.

## Как это работает

1. **Загрузка видео**: Видео скачивается как обычно через YouTube
2. **Проверка длительности**: Система проверяет длительность видео
3. **Разбиение** (если видео > 1 час):
   - Видео разбивается на части по 1 часу каждая
   - Используется `ffmpeg` в режиме copy (быстро, без перекодирования)
   - Оригинальный файл удаляется после успешного разбиения
4. **Создание эпизодов**: Для каждой части создается отдельный эпизод в RSS

## Примеры

### Короткое видео (< 1 часа)
- Видео 45 минут → 1 эпизод
- Название: "My Video"

### Длинное видео (> 1 часа)
- Видео 2 часа 15 минут → 3 эпизода:
  - "My Video (Part 1/3)" - 1:00:00
  - "My Video (Part 2/3)" - 1:00:00
  - "My Video (Part 3/3)" - 0:15:00

## Использование

### Веб-интерфейс

Просто вставьте URL видео как обычно. Система автоматически:
- Определит длительность
- Разобьет на части если нужно
- Покажет прогресс разбиения
- Создаст отдельные эпизоды

### CLI

```bash
python yt2pod.py "https://youtube.com/watch?v=VIDEO_ID"
```

Вывод для длинного видео:
```
Processing video: VIDEO_ID
  ✓ Downloaded: VIDEO_ID.mp3
  Title: Long Tutorial
  Duration: 02:15:30
  Uploader: Tech Channel
  Video duration (02:15:30) exceeds 1 hour, splitting into parts...
  Creating part 1/3: VIDEO_ID_part1.mp3 (3600s)
  Creating part 2/3: VIDEO_ID_part2.mp3 (3600s)
  Creating part 3/3: VIDEO_ID_part3.mp3 (930s)
  ✓ Split into 3 parts
  ✓ Removed original file
  ✓ Added to RSS feed: Long Tutorial (Part 1/3)
  ✓ Added to RSS feed: Long Tutorial (Part 2/3)
  ✓ Added to RSS feed: Long Tutorial (Part 3/3)
```

## Настройки

### Максимальная длительность эпизода

По умолчанию: **1 час (3600 секунд)**

Чтобы изменить, отредактируйте `utils/audio_splitter.py`:

```python
class AudioSplitter:
    # Максимальная длительность в секундах
    MAX_EPISODE_DURATION = 3600  # Измените на нужное значение
```

Примеры:
- `3600` = 1 час
- `1800` = 30 минут
- `5400` = 1.5 часа
- `7200` = 2 часа

## Технические детали

### Формат имен файлов

- Оригинал: `VIDEO_ID.mp3`
- Части: `VIDEO_ID_part1.mp3`, `VIDEO_ID_part2.mp3`, ...

### GUID в RSS

- Оригинальный: `VIDEO_ID`
- Части: `VIDEO_ID_part1`, `VIDEO_ID_part2`, ...

### Разбиение аудио

Используется `ffmpeg` с опциями:
- `-ss` - начало сегмента
- `-t` - длительность сегмента
- `-c copy` - копирование без перекодирования (быстро и без потери качества)

### Обработка ошибок

Если разбиение не удалось:
- Система использует полное видео как один эпизод
- Выводится предупреждение в логах
- Процесс продолжается

## Примечания

1. **Требуется ffmpeg**: Убедитесь, что `ffmpeg` установлен и доступен в PATH
2. **Дисковое пространство**: Во время разбиения требуется место для оригинала и всех частей
3. **Время обработки**: Разбиение происходит быстро (~1-2 секунды на часть) благодаря режиму copy
4. **Публикация на GitHub**: Все части автоматически загружаются на GitHub Releases

## Проверка

Проверьте, что ffmpeg установлен:

```bash
ffmpeg -version
```

Если нет, установите:

**macOS:**
```bash
brew install ffmpeg
```

**Ubuntu/Debian:**
```bash
sudo apt install ffmpeg
```

**Windows:**
Скачайте с [ffmpeg.org](https://ffmpeg.org/download.html)
