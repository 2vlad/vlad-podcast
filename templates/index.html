<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>yt2pod</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <!-- Logo/Title Area -->
        <div class="header">
            <svg class="icon-logo" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/>
                <circle cx="12" cy="12" r="2"/>
            </svg>
        </div>

        <!-- Main Content -->
        <div class="content">
            <!-- URL Input Section -->
            <div class="input-section">
                <div class="input-group" id="inputGroup">
                    <input 
                        type="text" 
                        id="urlInput" 
                        placeholder="youtube.com/watch?v=..." 
                        autocomplete="off"
                        spellcheck="false"
                    />
                    <button id="submitBtn" class="btn-primary">
                        <svg class="icon-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M5 12h14M12 5l7 7-7 7"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Divider -->
            <div class="divider">
                <span class="divider-text">or</span>
            </div>

            <!-- Upload Section -->
            <div class="upload-section">
                <div class="upload-area">
                    <div class="upload-zone" id="uploadZone">
                        <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="17 8 12 3 7 8"/>
                            <line x1="12" y1="3" x2="12" y2="15"/>
                        </svg>
                        <p class="upload-text">Drop file here or click to browse</p>
                        <p class="upload-hint">MP3, MP4, M4A (max 500MB)</p>
                        <input type="file" id="fileInput" accept=".mp3,.mp4,.m4a" hidden />
                    </div>
                    
                    <div class="upload-metadata" id="uploadMetadata" style="display: none;">
                        <p class="selected-file" id="selectedFile"></p>
                        <input type="text" id="titleInput" placeholder="Episode Title (optional)" class="metadata-input" />
                        <textarea id="descriptionInput" placeholder="Description (optional)" class="metadata-input" rows="3"></textarea>
                        <button id="uploadBtn" class="btn-primary-full">Upload and Add</button>
                    </div>
                </div>
            </div>

            <!-- Status Area -->
            <div class="status" id="status" style="display: none;">
                <div class="status-header">
                    <div class="status-icon" id="statusIcon">
                        <!-- Loading spinner -->
                        <svg class="spinner" viewBox="0 0 50 50">
                            <circle cx="25" cy="25" r="20" fill="none" stroke-width="3"></circle>
                        </svg>
                    </div>
                    <div class="status-text" id="statusText"></div>
                </div>
                
                <!-- Progress Stages -->
                <div class="progress-stages" id="progressStages">
                    <div class="stage" data-stage="upload"><span class="stage-icon">○</span> Загрузка файла</div>
                    <div class="stage" data-stage="processing"><span class="stage-icon">○</span> Обработка</div>
                    <div class="stage" data-stage="converting"><span class="stage-icon">○</span> Конвертация</div>
                    <div class="stage" data-stage="metadata"><span class="stage-icon">○</span> Анализ</div>
                    <div class="stage" data-stage="splitting"><span class="stage-icon">○</span> Разбивка на части</div>
                    <div class="stage" data-stage="uploading"><span class="stage-icon">○</span> Загрузка на GitHub</div>
                    <div class="stage" data-stage="updating_rss"><span class="stage-icon">○</span> Обновление RSS</div>
                    <div class="stage" data-stage="publishing"><span class="stage-icon">○</span> Публикация</div>
                </div>
                
                <!-- Progress Bar -->
                <div class="progress-bar" id="progressBar" style="display: none;">
                    <div class="progress-fill" id="progressFill"></div>
                    <div class="progress-percent" id="progressPercent">0%</div>
                </div>
            </div>

            <!-- Result Area -->
            <div class="result" id="result" style="display: none;">
                <div class="result-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M20 6L9 17l-5-5"/>
                    </svg>
                </div>
                <div class="result-info">
                    <div class="result-title" id="resultTitle"></div>
                    <div class="result-meta" id="resultMeta"></div>
                    <div class="result-file" id="resultFile"></div>
                </div>
            </div>

            <!-- Error Area -->
            <div class="error" id="error" style="display: none;">
                <div class="error-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M15 9l-6 6M9 9l6 6"/>
                    </svg>
                </div>
                <div class="error-text" id="errorText"></div>
            </div>
        </div>

        <!-- Episodes List -->
        <div class="episodes-section" id="episodesSection">
            <div class="episodes-header">
                <h2 class="episodes-title">Episodes</h2>
                <span class="episodes-count" id="episodesCount">0</span>
            </div>
            <div class="episodes-list" id="episodesList">
                <!-- Episodes will be loaded here -->
                <div class="episodes-loading">
                    <svg class="spinner-small" viewBox="0 0 50 50">
                        <circle cx="25" cy="25" r="20" fill="none" stroke-width="3"></circle>
                    </svg>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <span id="podcastInfo"></span>
        </div>
    </div>

    <!-- Audio Player (Fixed at bottom) -->
    <div class="audio-player" id="audioPlayer" style="display: none;">
        <div class="audio-player-content">
            <button class="audio-player-close" id="audioPlayerClose">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
            
            <div class="audio-player-info">
                <div class="audio-player-title" id="audioPlayerTitle">Episode Title</div>
                <div class="audio-player-meta" id="audioPlayerMeta">00:00 / 00:00</div>
            </div>
            
            <div class="audio-player-controls">
                <button class="audio-player-btn" id="audioPlayerPlayPause">
                    <svg class="play-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="5 3 19 12 5 21 5 3"/>
                    </svg>
                    <svg class="pause-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;">
                        <rect x="6" y="4" width="4" height="16"/>
                        <rect x="14" y="4" width="4" height="16"/>
                    </svg>
                </button>
                
                <input type="range" class="audio-player-progress" id="audioPlayerProgress" min="0" max="100" value="0" step="0.1"/>
                
                <button class="audio-player-volume" id="audioPlayerVolume">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/>
                        <path d="M15.54 8.46a5 5 0 0 1 0 7.07"/>
                    </svg>
                </button>
            </div>
            
            <audio id="audioElement" preload="metadata"></audio>
        </div>
    </div>

    <!-- Chat Panel (Fixed Right) -->
    <div class="chat-panel" id="chatPanel">
        <div class="chat-header" id="chatHeader">
            <div class="chat-header-left">
                <div class="chat-title">Чат об эпизоде</div>
                <div class="chat-status" id="chatTranscriptStatus" title="Статус транскрипции">—</div>
            </div>
            <div class="chat-header-controls">
                <button class="chat-collapse-btn" id="chatCollapseBtn" title="Свернуть/Развернуть">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="18 15 12 9 6 15"/>
                    </svg>
                </button>
            </div>
        </div>
        <div class="chat-messages" id="chatMessages"></div>
        <div class="chat-input">
            <input type="text" id="chatInput" placeholder="Спросите про текущий эпизод..." disabled />
            <button id="chatSend" class="btn-primary" title="Отправить">
                <svg class="icon-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M5 12h14M12 5l7 7-7 7"/>
                </svg>
            </button>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
